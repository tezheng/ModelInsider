
[94m================================================================================[0m
[1;97mğŸ“‹ STEP 1/8: MODEL PREPARATION[0m
[94m================================================================================[0m
[32mâœ… Model loaded: BertModel (48 modules, 4.4M parameters)[0m
[36mğŸ¯ Export target: [0m
[36m/home/zhengte/modelexport_allmodels/experiments/export_monitor/iterations/iterat[0m
[36mion_007/model.onnx[0m
[33mâš™ï¸ Strategy: HTP (Hierarchy-Preserving)[0m
[32mâœ… Hierarchy attributes will be embedded in ONNX[0m
[32mâœ… Model set to evaluation mode[0m

[94m================================================================================[0m
[1;97mğŸ”§ STEP 2/8: INPUT GENERATION & VALIDATION[0m
[94m================================================================================[0m
[34mğŸ¤– Auto-generating inputs for: prajjwal1/bert-tiny[0m
   â€¢ Model type: bert
   â€¢ Auto-detected task: feature-extraction
[32mâœ… Created onnx export config for bert with task feature-extraction[0m
[33mğŸ”§ Generated 2 input tensors:[0m
[2m   â€¢ input_ids: torch.Size([1, 128]) (torch.int64)[0m
[2m   â€¢ attention_mask: torch.Size([1, 128]) (torch.int64)[0m

[94m================================================================================[0m
[1;97mğŸ—ï¸ STEP 3/8: HIERARCHY BUILDING[0m
[94m================================================================================[0m
[32mâœ… Hierarchy building completed with TracingHierarchyBuilder[0m
[36mğŸ“ˆ Traced 18 modules[0m
[33mğŸ”„ Execution steps: 36[0m

[1;32mğŸŒ³ Module Hierarchy:[0m
[2m------------------------------------------------------------[0m
[1;36mBertModel[0m
[37mâ”œâ”€â”€ BertEmbeddings: embeddings[0m
[37mâ”œâ”€â”€ BertEncoder: encoder[0m
[97mâ”‚   â”œâ”€â”€ BertLayer: encoder.layer.0[0m
[97mâ”‚   â”‚   â”œâ”€â”€ BertAttention: encoder.layer.0.attention[0m
[97mâ”‚   â”‚   â”‚   â”œâ”€â”€ BertSelfOutput: encoder.layer.0.attention.output[0m
[97mâ”‚   â”‚   â”‚   â””â”€â”€ BertSdpaSelfAttention: encoder.layer.0.attention.self[0m
[97mâ”‚   â”‚   â”œâ”€â”€ BertIntermediate: encoder.layer.0.intermediate[0m
[97mâ”‚   â”‚   â”‚   â””â”€â”€ GELUActivation: encoder.layer.0.intermediate.intermediate_act_fn[0m
[97mâ”‚   â”‚   â””â”€â”€ BertOutput: encoder.layer.0.output[0m
[97mâ”‚   â””â”€â”€ BertLayer: encoder.layer.1[0m
[97mâ”‚       â”œâ”€â”€ BertAttention: encoder.layer.1.attention[0m
[97mâ”‚       â”‚   â”œâ”€â”€ BertSelfOutput: encoder.layer.1.attention.output[0m
[97mâ”‚       â”‚   â””â”€â”€ BertSdpaSelfAttention: encoder.layer.1.attention.self[0m
[97mâ”‚       â”œâ”€â”€ BertIntermediate: encoder.layer.1.intermediate[0m
[97mâ”‚       â”‚   â””â”€â”€ GELUActivation: encoder.layer.1.intermediate.intermediate_act_fn[0m
[97mâ”‚       â””â”€â”€ BertOutput: encoder.layer.1.output[0m
[37mâ””â”€â”€ BertPooler: pooler[0m

[94m================================================================================[0m
[1;97mğŸ“¦ STEP 4/8: ONNX EXPORT[0m
[94m================================================================================[0m
[36mğŸ¯ Target file: [0m
[36m/home/zhengte/modelexport_allmodels/experiments/export_monitor/iterations/iterat[0m
[36mion_007/model.onnx[0m
[33mâš™ï¸ Export config:[0m
   â€¢ opset_version: 17
   â€¢ do_constant_folding: True
   â€¢ verbose: False
[32mâœ… ONNX export completed successfully[0m

[94m================================================================================[0m
[1;97mğŸ·ï¸ STEP 5/8: NODE TAGGER CREATION[0m
[94m================================================================================[0m
[32mâœ… Node tagger created successfully[0m
[36mğŸ·ï¸ Model root tag: /BertModel[0m
[33mğŸ”§ Operation fallback: disabled[0m

[94m================================================================================[0m
[1;97mğŸ”— STEP 6/8: ONNX NODE TAGGING[0m
[94m================================================================================[0m
[32mâœ… Node tagging completed successfully[0m
[36mğŸ“ˆ Coverage: 100.0%[0m
[33mğŸ“Š Tagged nodes: 136/136[0m
   â€¢ Direct matches: 83 (61.0%)
   â€¢ Parent matches: 34 (25.0%)
   â€¢ Root fallbacks: 19 (14.0%)
[32mâœ… Empty tags: 0[0m

[1;33mğŸ“Š Top 20 Nodes by Hierarchy:[0m
[2m------------------------------[0m
[37m 1. /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention: 35 [0m
[37mnodes[0m
[37m 2. /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention: 35 [0m
[37mnodes[0m
[37m 3. /BertModel: 19 nodes[0m
[37m 4. /BertModel/BertEncoder/BertLayer.0/BertIntermediate: 10 nodes[0m
[37m 5. /BertModel/BertEncoder/BertLayer.1/BertIntermediate: 10 nodes[0m
[37m 6. /BertModel/BertEmbeddings: 8 nodes[0m
[37m 7. /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSelfOutput: 4 nodes[0m
[37m 8. /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSelfOutput: 4 nodes[0m
[37m 9. /BertModel/BertEncoder/BertLayer.0/BertOutput: 4 nodes[0m
[37m10. /BertModel/BertEncoder/BertLayer.1/BertOutput: 4 nodes[0m
[2m11. /BertModel/BertPooler: 3 nodes[0m

[1;32mğŸŒ³ Complete HF Hierarchy with ONNX Nodes:[0m
[2m------------------------------------------------------------[0m
[1;36mBertModel (136 ONNX nodes)[0m
[97mâ”œâ”€â”€ BertEmbeddings: embeddings (8 nodes)[0m
[35mâ”‚   â””â”€â”€ node (8 ops)[0m
[2mâ”œâ”€â”€ BertEncoder: encoder (0 nodes)[0m
[2mâ”‚   â”œâ”€â”€ BertLayer: encoder.layer.0 (0 nodes)[0m
[2mâ”‚   â”‚   â”œâ”€â”€ BertAttention: encoder.layer.0.attention (0 nodes)[0m
[97mâ”‚   â”‚   â”‚   â”œâ”€â”€ BertSelfOutput: encoder.layer.0.attention.output (4 nodes)[0m
[97mâ”‚   â”‚   â”‚   â””â”€â”€ BertSdpaSelfAttention: encoder.layer.0.attention.self (35 nodes)[0m
[97mâ”‚   â”‚   â”œâ”€â”€ BertIntermediate: encoder.layer.0.intermediate (10 nodes)[0m
[35mâ”‚   â”‚   â”‚   â””â”€â”€ node (10 ops)[0m
[2mâ”‚   â”‚   â”‚   â””â”€â”€ GELUActivation: encoder.layer.0.intermediate.intermediate_act_fn[0m
[2m(0 nodes)[0m
[97mâ”‚   â”‚   â””â”€â”€ BertOutput: encoder.layer.0.output (4 nodes)[0m
[35mâ”‚   â”‚       â””â”€â”€ node (4 ops)[0m
[2mâ”‚   â””â”€â”€ BertLayer: encoder.layer.1 (0 nodes)[0m
[2mâ”‚       â”œâ”€â”€ BertAttention: encoder.layer.1.attention (0 nodes)[0m
[97mâ”‚       â”‚   â”œâ”€â”€ BertSelfOutput: encoder.layer.1.attention.output (4 nodes)[0m
[97mâ”‚       â”‚   â””â”€â”€ BertSdpaSelfAttention: encoder.layer.1.attention.self (35 nodes)[0m
[97mâ”‚       â”œâ”€â”€ BertIntermediate: encoder.layer.1.intermediate (10 nodes)[0m
[35mâ”‚       â”‚   â””â”€â”€ node (10 ops)[0m
[2mâ”‚       â”‚   â””â”€â”€ GELUActivation: encoder.layer.1.intermediate.intermediate_act_fn[0m
[2m(0 nodes)[0m
[97mâ”‚       â””â”€â”€ BertOutput: encoder.layer.1.output (4 nodes)[0m
[35mâ”‚           â””â”€â”€ node (4 ops)[0m
[97mâ””â”€â”€ BertPooler: pooler (3 nodes)[0m
[35m    â””â”€â”€ node (3 ops)[0m
[2m(showing 23/135 lines)[0m

[94m================================================================================[0m
[1;97mğŸ·ï¸ STEP 7/8: TAG INJECTION[0m
[94m================================================================================[0m
[36mğŸ·ï¸ Hierarchy tag attributes: enabled[0m
[32mâœ… Tags injected into ONNX model successfully[0m
[33mğŸ“„ Updated ONNX file: [0m
[33m/home/zhengte/modelexport_allmodels/experiments/export_monitor/iterations/iterat[0m
[33mion_007/model.onnx[0m

[94m================================================================================[0m
[1;97mğŸ“„ STEP 8/8: METADATA GENERATION[0m
[94m================================================================================[0m
[32mâœ… Metadata file created successfully[0m
[33mğŸ“„ Metadata file: [0m
[33m/home/zhengte/modelexport_allmodels/experiments/export_monitor/iterations/iterat[0m
[33mion_007/model_htp_metadata.json[0m

[94m================================================================================[0m
[1;97mğŸ“‹ FINAL EXPORT SUMMARY[0m
[94m================================================================================[0m
[1;32mğŸ‰ HTP Export completed successfully in 0.02s![0m
[36mğŸ“Š Export Statistics:[0m
   â€¢ Export time: 0.02s
   â€¢ Hierarchy modules: 18
   â€¢ ONNX nodes: 136
   â€¢ Tagged nodes: 136
   â€¢ Coverage: 100.0%
[32m   â€¢ Empty tags: 0 âœ…[0m

[1;36mğŸ“ Output Files:[0m
   â€¢ ONNX model: 
/home/zhengte/modelexport_allmodels/experiments/export_monitor/iterations/iterat
ion_007/model.onnx
   â€¢ Metadata: 
/home/zhengte/modelexport_allmodels/experiments/export_monitor/iterations/iterat
ion_007/model_htp_metadata.json
   â€¢ Report: 
/home/zhengte/modelexport_allmodels/experiments/export_monitor/iterations/iterat
ion_007/model_full_report.txt
