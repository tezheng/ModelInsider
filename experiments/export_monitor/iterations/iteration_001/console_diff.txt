--- baseline
+++ iteration_1
@@ -1,15 +1,13 @@
 ğŸ”„ Loading model and exporting: prajjwal1/bert-tiny

 ğŸ§  Using HTP (Hierarchical Trace-and-Project) strategy

-Auto-loading model from: prajjwal1/bert-tiny

-Successfully loaded BertModel

-Starting HTP export for BertModel

 

 ================================================================================

 ğŸ“‹ STEP 1/8: MODEL PREPARATION

 ================================================================================

 âœ… Model loaded: BertModel (48 modules, 4.4M parameters)

-ğŸ¯ Export target: temp/baseline/model.onnx

+ğŸ¯ Export target: experiments/export_monitor/iterations/iteration_001/model.onnx

 âš™ï¸ Strategy: HTP (Hierarchy-Preserving)

+âœ… Hierarchy attributes will be embedded in ONNX

 âœ… Model set to evaluation mode

 

 ================================================================================

@@ -17,7 +15,7 @@
 ================================================================================

 ğŸ¤– Auto-generating inputs for: prajjwal1/bert-tiny

    â€¢ Model type: bert

-   â€¢ Auto-detected task: feature-extraction

+   â€¢ Task: feature-extraction

 âœ… Created onnx export config for bert with task feature-extraction

 ğŸ”§ Generated 3 input tensors:

    â€¢ input_ids: [2, 16] (torch.int64)

@@ -36,31 +34,31 @@
 BertModel

 â”œâ”€â”€ BertEmbeddings: embeddings

 â”œâ”€â”€ BertEncoder: encoder

-â”‚   â”œâ”€â”€ BertLayer: encoder.layer.0

-â”‚   â”‚   â”œâ”€â”€ BertAttention: encoder.layer.0.attention

-â”‚   â”‚   â”‚   â”œâ”€â”€ BertSdpaSelfAttention: encoder.layer.0.attention.self

-â”‚   â”‚   â”‚   â””â”€â”€ BertSelfOutput: encoder.layer.0.attention.output

-â”‚   â”‚   â”œâ”€â”€ BertIntermediate: encoder.layer.0.intermediate

-â”‚   â”‚   â”‚   â””â”€â”€ GELUActivation: encoder.layer.0.intermediate.intermediate_act_fn

-â”‚   â”‚   â””â”€â”€ BertOutput: encoder.layer.0.output

-â”‚   â””â”€â”€ BertLayer: encoder.layer.1

-â”‚       â”œâ”€â”€ BertAttention: encoder.layer.1.attention

-â”‚       â”‚   â”œâ”€â”€ BertSdpaSelfAttention: encoder.layer.1.attention.self

-â”‚       â”‚   â””â”€â”€ BertSelfOutput: encoder.layer.1.attention.output

-â”‚       â”œâ”€â”€ BertIntermediate: encoder.layer.1.intermediate

-â”‚       â”‚   â””â”€â”€ GELUActivation: encoder.layer.1.intermediate.intermediate_act_fn

-â”‚       â””â”€â”€ BertOutput: encoder.layer.1.output

+â”‚   â”œâ”€â”€ BertLayer: layer.0

+â”‚   â”‚   â”œâ”€â”€ BertAttention: attention

+â”‚   â”‚   â”‚   â”œâ”€â”€ BertSelfOutput: output

+â”‚   â”‚   â”‚   â””â”€â”€ BertSdpaSelfAttention: self

+â”‚   â”‚   â”œâ”€â”€ BertIntermediate: intermediate

+â”‚   â”‚   â”‚   â””â”€â”€ GELUActivation: intermediate_act_fn

+â”‚   â”‚   â””â”€â”€ BertOutput: output

+â”‚   â””â”€â”€ BertLayer: layer.1

+â”‚       â”œâ”€â”€ BertAttention: attention

+â”‚       â”‚   â”œâ”€â”€ BertSelfOutput: output

+â”‚       â”‚   â””â”€â”€ BertSdpaSelfAttention: self

+â”‚       â”œâ”€â”€ BertIntermediate: intermediate

+â”‚       â”‚   â””â”€â”€ GELUActivation: intermediate_act_fn

+â”‚       â””â”€â”€ BertOutput: output

 â””â”€â”€ BertPooler: pooler

+(showing 18/18 lines)

 

 ================================================================================

 ğŸ“¦ STEP 4/8: ONNX EXPORT

 ================================================================================

-ğŸ¯ Target file: temp/baseline/model.onnx

+ğŸ¯ Target file: experiments/export_monitor/iterations/iteration_001/model.onnx

 âš™ï¸ Export config:

    â€¢ opset_version: 17

    â€¢ do_constant_folding: True

    â€¢ verbose: False

-   â€¢ input_names: ['input_ids', 'attention_mask', 'token_type_ids']

 âœ… ONNX export completed successfully

 

 ================================================================================

@@ -81,7 +79,7 @@
    â€¢ Root fallbacks: 19 (14.0%)

 âœ… Empty tags: 0

 

-ğŸ“Š Top 20 Nodes by Hierarchy:

+ğŸ“Š Top 13 Nodes by Hierarchy:

 ------------------------------

  1. /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention: 35 nodes

  2. /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention: 35 nodes

@@ -101,56 +99,64 @@
 ------------------------------------------------------------

 BertModel (136 ONNX nodes)

 â”œâ”€â”€ BertEmbeddings: embeddings (8 nodes)

-â”‚   â”œâ”€â”€ Add (2 ops)

-â”‚   â”œâ”€â”€ Constant (2 ops)

-â”‚   â”œâ”€â”€ Gather (3 ops)

-â”‚   â””â”€â”€ LayerNormalization: /embeddings/LayerNorm/LayerNormalization

-â”œâ”€â”€ BertEncoder: encoder (106 nodes)

-â”‚   â”œâ”€â”€ BertLayer: encoder.layer.0 (53 nodes)

-â”‚   â”‚   â”œâ”€â”€ BertAttention: encoder.layer.0.attention (39 nodes)

-â”‚   â”‚   â”‚   â”œâ”€â”€ BertSdpaSelfAttention: encoder.layer.0.attention.self (35 nodes)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Add (4 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Cast (2 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Constant (7 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Div: /encoder/layer.0/attention/self/Div

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MatMul (5 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Mul (2 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Reshape (4 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Shape: /encoder/layer.0/attention/self/Shape

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Slice: /encoder/layer.0/attention/self/Slice

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Softmax: /encoder/layer.0/attention/self/Softmax

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Sqrt (3 ops)

-â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Transpose (4 ops)

-â”‚   â”‚   â”‚   â””â”€â”€ BertSelfOutput: encoder.layer.0.attention.output (4 nodes)

-â”‚   â”‚   â”‚       â”œâ”€â”€ Add (2 ops)

-â”‚   â”‚   â”‚       â”œâ”€â”€ LayerNormalization:

-â”‚   â”‚   â”‚       â”‚   /encoder/layer.0/attention/output/LayerNorm/LayerNormalizati

-â”‚   â”‚   â”‚       â”‚   on

-â”‚   â”‚   â”‚       â””â”€â”€ MatMul: /encoder/layer.0/attention/output/dense/MatMul

-â”‚   â”‚   â”œâ”€â”€ BertIntermediate: encoder.layer.0.intermediate (10 nodes)

-â”‚   â”‚   â”‚   â”œâ”€â”€ Add: /encoder/layer.0/intermediate/dense/Add

-... and 53 more lines (truncated for console)

-(showing 30/83 lines)

+â”‚   â”œâ”€â”€ /embeddings/Constant (2 ops)

+â”‚   â”œâ”€â”€ /embeddings/Add (2 ops)

+â”‚   â”œâ”€â”€ /embeddings/word: /embeddings/word_embeddings/Gather

+â”‚   â”œâ”€â”€ /embeddings/token: /embeddings/token_type_embeddings/Gather

+â”‚   â”œâ”€â”€ /embeddings/position: /embeddings/position_embeddings/Gather

+â”œâ”€â”€ BertEncoder: encoder (0 nodes)

+â”‚   â”œâ”€â”€ BertLayer: layer.0 (0 nodes)

+â”‚   â”‚   â”œâ”€â”€ BertAttention: attention (0 nodes)

+â”‚   â”‚   â”‚   â”œâ”€â”€ BertSelfOutput: output (4 nodes)

+â”‚   â”‚   â”‚   â”œâ”€â”€ BertSdpaSelfAttention: self (35 nodes)

+â”‚   â”‚   â”œâ”€â”€ BertIntermediate: intermediate (2 nodes)

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.0/intermediate/dense/MatMul: /encoder/layer.0/intermediate/dense/MatMul

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.0/intermediate/dense/Add: /encoder/layer.0/intermediate/dense/Add

+â”‚   â”‚   â”‚   â”œâ”€â”€ GELUActivation: intermediate_act_fn (8 nodes)

+â”‚   â”‚   â”œâ”€â”€ BertOutput: output (4 nodes)

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.0/output/dense/MatMul: /encoder/layer.0/output/dense/MatMul

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.0/output/dense/Add: /encoder/layer.0/output/dense/Add

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.0/output/Add: /encoder/layer.0/output/Add

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.0/output/LayerNorm/LayerNormalization: /encoder/layer.0/output/LayerNorm/LayerNormalization

+â”‚   â”œâ”€â”€ BertLayer: layer.1 (0 nodes)

+â”‚   â”‚   â”œâ”€â”€ BertAttention: attention (0 nodes)

+â”‚   â”‚   â”‚   â”œâ”€â”€ BertSelfOutput: output (4 nodes)

+â”‚   â”‚   â”‚   â”œâ”€â”€ BertSdpaSelfAttention: self (35 nodes)

+â”‚   â”‚   â”œâ”€â”€ BertIntermediate: intermediate (2 nodes)

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.1/intermediate/dense/MatMul: /encoder/layer.1/intermediate/dense/MatMul

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.1/intermediate/dense/Add: /encoder/layer.1/intermediate/dense/Add

+â”‚   â”‚   â”‚   â”œâ”€â”€ GELUActivation: intermediate_act_fn (8 nodes)

+â”‚   â”‚   â”œâ”€â”€ BertOutput: output (4 nodes)

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.1/output/dense/MatMul: /encoder/layer.1/output/dense/MatMul

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.1/output/dense/Add: /encoder/layer.1/output/dense/Add

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.1/output/Add: /encoder/layer.1/output/Add

+â”‚   â”‚   â”‚   â”œâ”€â”€ /encoder/layer.1/output/LayerNorm/LayerNormalization: /encoder/layer.1/output/LayerNorm/LayerNormalization

+â”œâ”€â”€ BertPooler: pooler (3 nodes)

+â”‚   â”œâ”€â”€ /pooler/Gather: /pooler/Gather

+â”‚   â”œâ”€â”€ /pooler/dense/Gemm: /pooler/dense/Gemm

+â”‚   â”œâ”€â”€ /pooler/activation/Tanh: /pooler/activation/Tanh

+... and 98 more lines (truncated for console)

+(showing 38/136 lines)

 

 ================================================================================

 ğŸ·ï¸ STEP 7/8: TAG INJECTION

 ================================================================================

 ğŸ·ï¸ Hierarchy tag attributes: enabled

 âœ… Tags injected into ONNX model successfully

-ğŸ“„ Updated ONNX file: temp/baseline/model.onnx

+ğŸ“„ Updated ONNX file: experiments/export_monitor/iterations/iteration_001/model.onnx

 

 ================================================================================

 ğŸ“„ STEP 8/8: METADATA GENERATION

 ================================================================================

 âœ… Metadata file created successfully

-ğŸ“„ Metadata file: temp/baseline/model_htp_metadata.json

+ğŸ“„ Metadata file: experiments/export_monitor/iterations/iteration_001/model_htp_metadata.json

 

 ================================================================================

 ğŸ“‹ FINAL EXPORT SUMMARY

 ================================================================================

-ğŸ‰ HTP Export completed successfully in 4.83s!

+ğŸ‰ HTP Export completed successfully in 4.42s!

 ğŸ“Š Export Statistics:

-   â€¢ Export time: 4.83s

+   â€¢ Export time: 4.42s

    â€¢ Hierarchy modules: 18

    â€¢ ONNX nodes: 136

    â€¢ Tagged nodes: 136

@@ -158,6 +164,6 @@
    â€¢ Empty tags: 0 âœ…

 

 ğŸ“ Output Files:

-   â€¢ ONNX model: temp/baseline/model.onnx

-   â€¢ Metadata: temp/baseline/model_htp_metadata.json

-   â€¢ Report: temp/baseline/model_htp_export_report.txt

+   â€¢ ONNX model: experiments/export_monitor/iterations/iteration_001/model.onnx

+   â€¢ Metadata: experiments/export_monitor/iterations/iteration_001/model_htp_metadata.json

+   â€¢ Report: experiments/export_monitor/iterations/iteration_001/model_full_report.txt
