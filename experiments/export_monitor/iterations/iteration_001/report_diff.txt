--- baseline
+++ iteration_1
@@ -1,159 +1,310 @@
-

 ================================================================================

-ğŸ“‹ STEP 1/8: MODEL PREPARATION

+HTP EXPORT FULL REPORT

 ================================================================================

-âœ… Model loaded: BertModel (48 modules, 4.4M parameters)

-ğŸ¯ Export target: temp/baseline/model.onnx

-âš™ï¸ Strategy: HTP (Hierarchy-Preserving)

-âœ… Model set to evaluation mode

+Generated: 2025-07-19T00:16:44Z

+

+

+MODEL INFORMATION

+----------------------------------------

+Model Name: prajjwal1/bert-tiny

+Model Class: BertModel

+Total Modules: 48

+Total Parameters: 4,385,920

+Export Strategy: HTP

+Output Path: experiments/export_monitor/iterations/iteration_001/model.onnx

+Embed Hierarchy: True

+

+INPUT GENERATION

+----------------------------------------

+Model Type: bert

+Task: feature-extraction

+Method: auto_generated

+

+Generated Inputs:

+  input_ids: shape=[2, 16], dtype=torch.int64

+  attention_mask: shape=[2, 16], dtype=torch.int64

+  token_type_ids: shape=[2, 16], dtype=torch.int64

+

+COMPLETE MODULE HIERARCHY

+----------------------------------------

+

+Module: [ROOT]

+  Class: BertModel

+  Tag: /BertModel

+  Type: huggingface

+  Execution Order: 0

+

+Module: embeddings

+  Class: BertEmbeddings

+  Tag: /BertModel/BertEmbeddings

+  Type: huggingface

+  Execution Order: 1

+

+Module: encoder

+  Class: BertEncoder

+  Tag: /BertModel/BertEncoder

+  Type: huggingface

+  Execution Order: 2

+

+Module: pooler

+  Class: BertPooler

+  Tag: /BertModel/BertPooler

+  Type: huggingface

+  Execution Order: 17

+

+Module: encoder.layer.0

+  Class: BertLayer

+  Tag: /BertModel/BertEncoder/BertLayer.0

+  Type: huggingface

+  Execution Order: 3

+

+Module: encoder.layer.1

+  Class: BertLayer

+  Tag: /BertModel/BertEncoder/BertLayer.1

+  Type: huggingface

+  Execution Order: 10

+

+Module: encoder.layer.0.attention

+  Class: BertAttention

+  Tag: /BertModel/BertEncoder/BertLayer.0/BertAttention

+  Type: huggingface

+  Execution Order: 4

+

+Module: encoder.layer.0.intermediate

+  Class: BertIntermediate

+  Tag: /BertModel/BertEncoder/BertLayer.0/BertIntermediate

+  Type: huggingface

+  Execution Order: 7

+

+Module: encoder.layer.0.output

+  Class: BertOutput

+  Tag: /BertModel/BertEncoder/BertLayer.0/BertOutput

+  Type: huggingface

+  Execution Order: 9

+

+Module: encoder.layer.1.attention

+  Class: BertAttention

+  Tag: /BertModel/BertEncoder/BertLayer.1/BertAttention

+  Type: huggingface

+  Execution Order: 11

+

+Module: encoder.layer.1.intermediate

+  Class: BertIntermediate

+  Tag: /BertModel/BertEncoder/BertLayer.1/BertIntermediate

+  Type: huggingface

+  Execution Order: 14

+

+Module: encoder.layer.1.output

+  Class: BertOutput

+  Tag: /BertModel/BertEncoder/BertLayer.1/BertOutput

+  Type: huggingface

+  Execution Order: 16

+

+Module: encoder.layer.0.attention.output

+  Class: BertSelfOutput

+  Tag: /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSelfOutput

+  Type: huggingface

+  Execution Order: 6

+

+Module: encoder.layer.0.attention.self

+  Class: BertSdpaSelfAttention

+  Tag: /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+  Type: huggingface

+  Execution Order: 5

+

+Module: encoder.layer.0.intermediate.intermediate_act_fn

+  Class: GELUActivation

+  Tag: /BertModel/BertEncoder/BertLayer.0/BertIntermediate/GELUActivation

+  Type: huggingface

+  Execution Order: 8

+

+Module: encoder.layer.1.attention.output

+  Class: BertSelfOutput

+  Tag: /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSelfOutput

+  Type: huggingface

+  Execution Order: 13

+

+Module: encoder.layer.1.attention.self

+  Class: BertSdpaSelfAttention

+  Tag: /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+  Type: huggingface

+  Execution Order: 12

+

+Module: encoder.layer.1.intermediate.intermediate_act_fn

+  Class: GELUActivation

+  Tag: /BertModel/BertEncoder/BertLayer.1/BertIntermediate/GELUActivation

+  Type: huggingface

+  Execution Order: 15

+

+Total Modules: 18

+

+[2025-07-18T16:16:48Z] onnx_export: Completed

+

+[2025-07-18T16:16:48Z] tagger_creation: Completed

+

+NODE TAGGING STATISTICS

+----------------------------------------

+Total ONNX Nodes: 136

+Tagged Nodes: 136

+Coverage: 100.0%

+  Root Nodes: 19

+  Scoped Nodes: 117

+  Unique Scopes: 32

+  Direct Matches: 83

+  Parent Matches: 34

+  Operation Matches: 0

+  Root Fallbacks: 19

+  Empty Tags: 0

+

+COMPLETE NODE MAPPINGS

+----------------------------------------

+/Cast -> /BertModel

+/Cast_1 -> /BertModel

+/Cast_2 -> /BertModel

+/Constant -> /BertModel

+/ConstantOfShape -> /BertModel

+/Constant_1 -> /BertModel

+/Constant_2 -> /BertModel

+/Constant_3 -> /BertModel

+/Constant_4 -> /BertModel

+/Constant_5 -> /BertModel

+/Constant_6 -> /BertModel

+/Equal -> /BertModel

+/Expand -> /BertModel

+/Mul -> /BertModel

+/Sub -> /BertModel

+/Unsqueeze -> /BertModel

+/Unsqueeze_1 -> /BertModel

+/Where -> /BertModel

+/Where_1 -> /BertModel

+/embeddings/Add -> /BertModel/BertEmbeddings

+/embeddings/Add_1 -> /BertModel/BertEmbeddings

+/embeddings/Constant -> /BertModel/BertEmbeddings

+/embeddings/Constant_1 -> /BertModel/BertEmbeddings

+/embeddings/LayerNorm/LayerNormalization -> /BertModel/BertEmbeddings

+/embeddings/position_embeddings/Gather -> /BertModel/BertEmbeddings

+/embeddings/token_type_embeddings/Gather -> /BertModel/BertEmbeddings

+/embeddings/word_embeddings/Gather -> /BertModel/BertEmbeddings

+/encoder/layer.0/attention/output/Add -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSelfOutput

+/encoder/layer.0/attention/output/LayerNorm/LayerNormalization -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSelfOutput

+/encoder/layer.0/attention/output/dense/Add -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSelfOutput

+/encoder/layer.0/attention/output/dense/MatMul -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSelfOutput

+/encoder/layer.0/attention/self/Add -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Cast -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Cast_1 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Constant -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Constant_1 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Constant_2 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Constant_3 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Constant_4 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Constant_5 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Constant_6 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Div -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/MatMul -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/MatMul_1 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Mul -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Mul_1 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Reshape -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Reshape_1 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Reshape_2 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Reshape_3 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Shape -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Slice -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Softmax -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Sqrt -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Sqrt_1 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Sqrt_2 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Transpose -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Transpose_1 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Transpose_2 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/Transpose_3 -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/key/Add -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/key/MatMul -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/query/Add -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/query/MatMul -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/value/Add -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/attention/self/value/MatMul -> /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention

+/encoder/layer.0/intermediate/dense/Add -> /BertModel/BertEncoder/BertLayer.0/BertIntermediate

+/encoder/layer.0/intermediate/dense/MatMul -> /BertModel/BertEncoder/BertLayer.0/BertIntermediate

+/encoder/layer.0/intermediate/intermediate_act_fn/Add -> /BertModel/BertEncoder/BertLayer.0/BertIntermediate/GELUActivation

+/encoder/layer.0/intermediate/intermediate_act_fn/Constant -> /BertModel/BertEncoder/BertLayer.0/BertIntermediate/GELUActivation

+/encoder/layer.0/intermediate/intermediate_act_fn/Constant_1 -> /BertModel/BertEncoder/BertLayer.0/BertIntermediate/GELUActivation

+/encoder/layer.0/intermediate/intermediate_act_fn/Constant_2 -> /BertModel/BertEncoder/BertLayer.0/BertIntermediate/GELUActivation

+/encoder/layer.0/intermediate/intermediate_act_fn/Div -> /BertModel/BertEncoder/BertLayer.0/BertIntermediate/GELUActivation

+/encoder/layer.0/intermediate/intermediate_act_fn/Erf -> /BertModel/BertEncoder/BertLayer.0/BertIntermediate/GELUActivation

+/encoder/layer.0/intermediate/intermediate_act_fn/Mul -> /BertModel/BertEncoder/BertLayer.0/BertIntermediate/GELUActivation

+/encoder/layer.0/intermediate/intermediate_act_fn/Mul_1 -> /BertModel/BertEncoder/BertLayer.0/BertIntermediate/GELUActivation

+/encoder/layer.0/output/Add -> /BertModel/BertEncoder/BertLayer.0/BertOutput

+/encoder/layer.0/output/LayerNorm/LayerNormalization -> /BertModel/BertEncoder/BertLayer.0/BertOutput

+/encoder/layer.0/output/dense/Add -> /BertModel/BertEncoder/BertLayer.0/BertOutput

+/encoder/layer.0/output/dense/MatMul -> /BertModel/BertEncoder/BertLayer.0/BertOutput

+/encoder/layer.1/attention/output/Add -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSelfOutput

+/encoder/layer.1/attention/output/LayerNorm/LayerNormalization -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSelfOutput

+/encoder/layer.1/attention/output/dense/Add -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSelfOutput

+/encoder/layer.1/attention/output/dense/MatMul -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSelfOutput

+/encoder/layer.1/attention/self/Add -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Cast -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Cast_1 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Constant -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Constant_1 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Constant_2 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Constant_3 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Constant_4 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Constant_5 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Constant_6 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Div -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/MatMul -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/MatMul_1 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Mul -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Mul_1 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Reshape -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Reshape_1 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Reshape_2 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Reshape_3 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Shape -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Slice -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Softmax -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Sqrt -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Sqrt_1 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Sqrt_2 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Transpose -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Transpose_1 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Transpose_2 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/Transpose_3 -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/key/Add -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/key/MatMul -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/query/Add -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/query/MatMul -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/value/Add -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/attention/self/value/MatMul -> /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention

+/encoder/layer.1/intermediate/dense/Add -> /BertModel/BertEncoder/BertLayer.1/BertIntermediate

+/encoder/layer.1/intermediate/dense/MatMul -> /BertModel/BertEncoder/BertLayer.1/BertIntermediate

+/encoder/layer.1/intermediate/intermediate_act_fn/Add -> /BertModel/BertEncoder/BertLayer.1/BertIntermediate/GELUActivation

+/encoder/layer.1/intermediate/intermediate_act_fn/Constant -> /BertModel/BertEncoder/BertLayer.1/BertIntermediate/GELUActivation

+/encoder/layer.1/intermediate/intermediate_act_fn/Constant_1 -> /BertModel/BertEncoder/BertLayer.1/BertIntermediate/GELUActivation

+/encoder/layer.1/intermediate/intermediate_act_fn/Constant_2 -> /BertModel/BertEncoder/BertLayer.1/BertIntermediate/GELUActivation

+/encoder/layer.1/intermediate/intermediate_act_fn/Div -> /BertModel/BertEncoder/BertLayer.1/BertIntermediate/GELUActivation

+/encoder/layer.1/intermediate/intermediate_act_fn/Erf -> /BertModel/BertEncoder/BertLayer.1/BertIntermediate/GELUActivation

+/encoder/layer.1/intermediate/intermediate_act_fn/Mul -> /BertModel/BertEncoder/BertLayer.1/BertIntermediate/GELUActivation

+/encoder/layer.1/intermediate/intermediate_act_fn/Mul_1 -> /BertModel/BertEncoder/BertLayer.1/BertIntermediate/GELUActivation

+/encoder/layer.1/output/Add -> /BertModel/BertEncoder/BertLayer.1/BertOutput

+/encoder/layer.1/output/LayerNorm/LayerNormalization -> /BertModel/BertEncoder/BertLayer.1/BertOutput

+/encoder/layer.1/output/dense/Add -> /BertModel/BertEncoder/BertLayer.1/BertOutput

+/encoder/layer.1/output/dense/MatMul -> /BertModel/BertEncoder/BertLayer.1/BertOutput

+/pooler/Gather -> /BertModel/BertPooler

+/pooler/activation/Tanh -> /BertModel/BertPooler

+/pooler/dense/Gemm -> /BertModel/BertPooler

+

+[2025-07-18T16:16:48Z] tag_injection: Completed

+

+[2025-07-18T16:16:48Z] metadata_generation: Completed

+

+EXPORT SUMMARY

+----------------------------------------

+Total Export Time: 4.42s

+ONNX File Size: 16.76MB

+Final Coverage: 100.0%

+Empty Tags: 0 âœ…

 

 ================================================================================

-ğŸ”§ STEP 2/8: INPUT GENERATION & VALIDATION

-================================================================================

-ğŸ¤– Auto-generating inputs for: prajjwal1/bert-tiny

-   â€¢ Model type: bert

-   â€¢ Auto-detected task: feature-extraction

-âœ… Created onnx export config for bert with task feature-extraction

-ğŸ”§ Generated 3 input tensors:

-   â€¢ input_ids: [2, 16] (torch.int64)

-   â€¢ attention_mask: [2, 16] (torch.int64)

-   â€¢ token_type_ids: [2, 16] (torch.int64)

-

-================================================================================

-ğŸ—ï¸ STEP 3/8: HIERARCHY BUILDING

-================================================================================

-âœ… Hierarchy building completed with TracingHierarchyBuilder

-ğŸ“ˆ Traced 18 modules

-ğŸ”„ Execution steps: 36

-

-ğŸŒ³ Module Hierarchy:

-------------------------------------------------------------

-BertModel

-â”œâ”€â”€ BertEmbeddings: embeddings

-â”œâ”€â”€ BertEncoder: encoder

-â”‚   â”œâ”€â”€ BertLayer: encoder.layer.0

-â”‚   â”‚   â”œâ”€â”€ BertAttention: encoder.layer.0.attention

-â”‚   â”‚   â”‚   â”œâ”€â”€ BertSdpaSelfAttention: encoder.layer.0.attention.self

-â”‚   â”‚   â”‚   â””â”€â”€ BertSelfOutput: encoder.layer.0.attention.output

-â”‚   â”‚   â”œâ”€â”€ BertIntermediate: encoder.layer.0.intermediate

-â”‚   â”‚   â”‚   â””â”€â”€ GELUActivation: encoder.layer.0.intermediate.intermediate_act_fn

-â”‚   â”‚   â””â”€â”€ BertOutput: encoder.layer.0.output

-â”‚   â””â”€â”€ BertLayer: encoder.layer.1

-â”‚       â”œâ”€â”€ BertAttention: encoder.layer.1.attention

-â”‚       â”‚   â”œâ”€â”€ BertSdpaSelfAttention: encoder.layer.1.attention.self

-â”‚       â”‚   â””â”€â”€ BertSelfOutput: encoder.layer.1.attention.output

-â”‚       â”œâ”€â”€ BertIntermediate: encoder.layer.1.intermediate

-â”‚       â”‚   â””â”€â”€ GELUActivation: encoder.layer.1.intermediate.intermediate_act_fn

-â”‚       â””â”€â”€ BertOutput: encoder.layer.1.output

-â””â”€â”€ BertPooler: pooler

-

-================================================================================

-ğŸ“¦ STEP 4/8: ONNX EXPORT

-================================================================================

-ğŸ¯ Target file: temp/baseline/model.onnx

-âš™ï¸ Export config:

-   â€¢ opset_version: 17

-   â€¢ do_constant_folding: True

-   â€¢ verbose: False

-   â€¢ input_names: ['input_ids', 'attention_mask', 'token_type_ids']

-âœ… ONNX export completed successfully

-

-================================================================================

-ğŸ·ï¸ STEP 5/8: NODE TAGGER CREATION

-================================================================================

-âœ… Node tagger created successfully

-ğŸ·ï¸ Model root tag: /BertModel

-ğŸ”§ Operation fallback: disabled

-

-================================================================================

-ğŸ”— STEP 6/8: ONNX NODE TAGGING

-================================================================================

-âœ… Node tagging completed successfully

-ğŸ“ˆ Coverage: 100.0%

-ğŸ“Š Tagged nodes: 136/136

-   â€¢ Direct matches: 83 (61.0%)

-   â€¢ Parent matches: 34 (25.0%)

-   â€¢ Root fallbacks: 19 (14.0%)

-âœ… Empty tags: 0

-

-ğŸ“Š Top 20 Nodes by Hierarchy:

-------------------------------

- 1. /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSdpaSelfAttention: 35 nodes

- 2. /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSdpaSelfAttention: 35 nodes

- 3. /BertModel: 19 nodes

- 4. /BertModel/BertEmbeddings: 8 nodes

- 5. /BertModel/BertEncoder/BertLayer.0/BertIntermediate/GELUActivation: 8 nodes

- 6. /BertModel/BertEncoder/BertLayer.1/BertIntermediate/GELUActivation: 8 nodes

- 7. /BertModel/BertEncoder/BertLayer.0/BertAttention/BertSelfOutput: 4 nodes

- 8. /BertModel/BertEncoder/BertLayer.0/BertOutput: 4 nodes

- 9. /BertModel/BertEncoder/BertLayer.1/BertAttention/BertSelfOutput: 4 nodes

-10. /BertModel/BertEncoder/BertLayer.1/BertOutput: 4 nodes

-11. /BertModel/BertPooler: 3 nodes

-12. /BertModel/BertEncoder/BertLayer.0/BertIntermediate: 2 nodes

-13. /BertModel/BertEncoder/BertLayer.1/BertIntermediate: 2 nodes

-

-ğŸŒ³ Complete HF Hierarchy with ONNX Nodes:

-------------------------------------------------------------

-BertModel (136 ONNX nodes)

-â”œâ”€â”€ BertEmbeddings: embeddings (8 nodes)

-â”‚   â”œâ”€â”€ Add (2 ops)

-â”‚   â”œâ”€â”€ Constant (2 ops)

-â”‚   â”œâ”€â”€ Gather (3 ops)

-â”‚   â””â”€â”€ LayerNormalization: /embeddings/LayerNorm/LayerNormalization

-â”œâ”€â”€ BertEncoder: encoder (106 nodes)

-â”‚   â”œâ”€â”€ BertLayer: encoder.layer.0 (53 nodes)

-â”‚   â”‚   â”œâ”€â”€ BertAttention: encoder.layer.0.attention (39 nodes)

-â”‚   â”‚   â”‚   â”œâ”€â”€ BertSdpaSelfAttention: encoder.layer.0.attention.self (35 nodes)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Add (4 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Cast (2 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Constant (7 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Div: /encoder/layer.0/attention/self/Div

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MatMul (5 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Mul (2 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Reshape (4 ops)

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Shape: /encoder/layer.0/attention/self/Shape

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Slice: /encoder/layer.0/attention/self/Slice

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Softmax: /encoder/layer.0/attention/self/Softmax

-â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Sqrt (3 ops)

-â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Transpose (4 ops)

-â”‚   â”‚   â”‚   â””â”€â”€ BertSelfOutput: encoder.layer.0.attention.output (4 nodes)

-â”‚   â”‚   â”‚       â”œâ”€â”€ Add (2 ops)

-â”‚   â”‚   â”‚       â”œâ”€â”€ LayerNormalization: 

-â”‚   â”‚   â”‚       â”‚   /encoder/layer.0/attention/output/LayerNorm/LayerNormalizati

-â”‚   â”‚   â”‚       â”‚   on

-â”‚   â”‚   â”‚       â””â”€â”€ MatMul: /encoder/layer.0/attention/output/dense/MatMul

-â”‚   â”‚   â”œâ”€â”€ BertIntermediate: encoder.layer.0.intermediate (10 nodes)

-â”‚   â”‚   â”‚   â”œâ”€â”€ Add: /encoder/layer.0/intermediate/dense/Add

-... and 53 more lines (truncated for console)

-(showing 30/83 lines)

-

-================================================================================

-ğŸ·ï¸ STEP 7/8: TAG INJECTION

-================================================================================

-ğŸ·ï¸ Hierarchy tag attributes: enabled

-âœ… Tags injected into ONNX model successfully

-ğŸ“„ Updated ONNX file: temp/baseline/model.onnx

-

-================================================================================

-ğŸ“„ STEP 8/8: METADATA GENERATION

-================================================================================

-âœ… Metadata file created successfully

-ğŸ“„ Metadata file: temp/baseline/model_htp_metadata.json

-

-================================================================================

-ğŸ“‹ FINAL EXPORT SUMMARY

-================================================================================

-ğŸ‰ HTP Export completed successfully in 4.83s!

-ğŸ“Š Export Statistics:

-   â€¢ Export time: 4.83s

-   â€¢ Hierarchy modules: 18

-   â€¢ ONNX nodes: 136

-   â€¢ Tagged nodes: 136

-   â€¢ Coverage: 100.0%

-   â€¢ Empty tags: 0 âœ…

-

-ğŸ“ Output Files:

-   â€¢ ONNX model: temp/baseline/model.onnx

-   â€¢ Metadata: temp/baseline/model_htp_metadata.json

-   â€¢ Report: temp/baseline/model_htp_export_report.txt

-

+Export completed successfully!
